// Valid Parentheses
// Given a string s containing just the characters '(', ')', '{', '}', '[' and ']', determine if the input string is valid.

function is_valid(list[char] s) -> bool {
    list[char] stack = [];

    num n = s.size();

    repeat i in range(0, n, 1) {
        rox_result[char] r = s.at(i);
        // If error, return false (invalid state)
        if (isOk(r)) {
            char c = getValue(r);

            if (c == '(' or c == '{' or c == '[') {
                stack.append(c);
            } else {
                // Closing bracket
                if (stack.size() == 0) {
                    return false;
                }

                num last_idx = stack.size() - 1;
                rox_result[char] rt = stack.at(last_idx);

                if (isOk(rt)) {
                    char top = getValue(rt);

                    stack.pop();

                    if (c == ')') {
                        if (not (top == '(')) { return false; }
                    } else if (c == '}') {
                        if (not (top == '{')) { return false; }
                    } else if (c == ']') {
                        if (not (top == '[')) { return false; }
                    }
                } else {
                    return false;
                }
            }
        } else {
            return false;
        }
    }

    return stack.size() == 0;
}

function main() -> none {
    // ROX strings are list[char]. String literals are converted.

    if (is_valid(['(', ')']) and is_valid(['(', ')', '[', ']', '{', '}'])) {
        if (not is_valid(['(', ']']) and not is_valid(['(', '[', ')', ']'])) {
            if (is_valid(['{', '[', ']', '}'])) {
                print("Valid Parentheses: Passed\n");
                return none;
            }
        }
    }

    print("Valid Parentheses: Failed\n");
}
