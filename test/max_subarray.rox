function max_sub_array(list[int64] int64s) -> int64 {
    int64 n = int64s.size();

    rox_result[int64] r0 = int64s.at(0);
    if (isOk(r0)) {
        int64 max_so_far = getValue(r0);
        int64 current_max = max_so_far;

        repeat i in range(1, n, 1) {
            rox_result[int64] r = int64s.at(i); // i is int64
            if (isOk(r)) {
                int64 x = getValue(r);

                // current_max = max(x, current_max + x)
                int64 sum = current_max + x;
                if (x > sum) {
                     current_max = x;
                } else {
                     current_max = sum;
                }

                if (current_max > max_so_far) {
                    max_so_far = current_max;
                }
            } else {
                return 0;
            }
        }
        return max_so_far;
    }
    return 0;
}

function main() -> none {
    // int64s = [-2, 1, -3, 4, -1, 2, 1, -5, 4]
    // Use n32 literals for strict typing
    list[int64] int64s = [-2, 1, -3, 4, -1, 2, 1, -5, 4];

    // Expected: 6 (from [4, -1, 2, 1])
    int64 res = max_sub_array(int64s);

    if (res == 6) {
        print("Maximum Subarray: Passed\n");
    } else {
        print("Maximum Subarray: Failed\n");
    }
}
